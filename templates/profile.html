{% include "_header.html" %}
{% include "_nav.html" %}

<main id="profile">
  <h1>My Profile</h1>

  <ul>
    <li><strong>Username:</strong> {{ user.user_username }}</li>
    <li><strong>Name:</strong> {{ user.user_name }} {{ user.user_last_name }}</li>
    <li><strong>Email:</strong> {{ user.user_email }}</li>
    <li><strong>Member since:</strong> {{ user.user_created_at }}</li>
  </ul>

  <p>
    <a href="{{ url_for('edit_profile') }}">Edit profile</a> |
    <a href="{{ url_for('delete_profile') }}">Delete profile</a>
  </p>

  <!-- Fejlbeskeder eller succes -->
  <div id="form-errors">
    {% if errors %}
      <ul class="error-list">
        {% for field, message in errors.items() %}
          <li>{{ message }}</li>
        {% endfor %}
      </ul>
    {% endif %}
    {% if success %}
      <p class="success-msg">{{ success }}</p>
    {% endif %}
  </div>

  <!-- Upload-formular -->
  <form id="item-form" mix-post="/item" enctype="multipart/form-data">
    <input name="item_name" type="text" placeholder="Name"
           value="{{ form.item_name if form else '' }}"
           class="{% if errors and errors.get('item_name') %}input-error{% endif %}" required>

    <textarea name="item_description" placeholder="Description" required
              class="{% if errors and errors.get('item_description') %}input-error{% endif %}">{{ form.item_description if form else '' }}</textarea>

    <input name="item_price" type="number" placeholder="Price"
           value="{{ form.item_price if form else '' }}"
           class="{% if errors and errors.get('item_price') %}input-error{% endif %}" required>

    <input name="item_address" type="text" placeholder="Address"
           value="{{ form.item_address if form else '' }}"
           class="{% if errors and errors.get('item_address') %}input-error{% endif %}" required>

    <input name="item_lat" type="text" placeholder="Latitude"
           value="{{ form.item_lat if form else '' }}"
           class="{% if errors and errors.get('item_lat') %}input-error{% endif %}" required>

    <input name="item_lon" type="text" placeholder="Longitude"
           value="{{ form.item_lon if form else '' }}"
           class="{% if errors and errors.get('item_lon') %}input-error{% endif %}" required>

    <input name="files" type="file" multiple>

    <button>Upload skate spot</button>
  </form>

  <!-- Dine items -->
  <section id="items">
    {% for item in items %}
      <div class="item-card" id="x{{ item.item_pk }}">
        <h2>{{ item.item_name }}</h2>
        <p><strong>Price:</strong> {{ item.item_price }} DKK</p>
        <p><strong>Address:</strong> {{ item.item_address }}</p>
        <p>{{ item.item_description }}</p>

        <div class="item-images">
          {% for img in item.images %}
            <div id="x{{ img.image_pk }}">
              <img class="uploaded_imgs_profile" src="/static/uploads/{{ img.image_name }}" alt="{{ img.image_name }}">
              <button mix-delete="/images/{{ img.image_pk }}">Delete</button>
            </div>
          {% endfor %}
        </div>
        <button mix-delete="/items/{{ item.item_pk }}">Delete Item</button>
      </div>
    {% endfor %}
  </section>
</main>

{% include "_footer_base.html" %}